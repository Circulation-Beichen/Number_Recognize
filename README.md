# 高性能手写数字识别程序

这个程序使用深度学习ResNet模型对MNIST数据集进行训练，然后识别自定义图像中的手写数字。

## 环境要求

需要安装以下Python库：
- numpy
- opencv-python (cv2)
- matplotlib
- pillow
- torch (PyTorch)
- torchvision

可以使用以下命令安装所需库：
```
conda install -c conda-forge numpy matplotlib opencv pillow
conda install -c pytorch pytorch torchvision
```

## 功能特点

1. **高级ResNet深度学习模型**：使用残差网络架构，比传统CNN具有更高的识别准确率
2. **自动保存和加载模型**：训练后的模型会被保存，避免每次运行都需要重新训练
3. **跨平台中文字体支持**：自动检测并加载Windows、Linux和macOS系统上的中文字体
4. **高级图像预处理**：
   - 自动检测并处理黑底白字或白底黑字的图像
   - 使用自适应阈值处理不同光照条件下的图像
   - 通过形态学操作去除噪点，提高识别准确率
   - 自动裁剪并居中数字，保持纵横比
5. **美观的结果展示**：显示识别结果和各数字的概率分布

## 使用方法

1. 确保已安装所有必要的库
2. 将手写数字图像命名为"Number.jpg"并放在程序相同目录下
3. 运行程序：
   ```
   python NumberRecognize.py
   ```

## 辅助工具

项目包含一个图像处理辅助工具`prepare_image.py`，可以帮助您：
1. 创建测试用的示例数字图像
2. 处理已有图像，优化其用于数字识别

运行辅助工具：
```
python prepare_image.py
```

## 技术细节

1. **ResNet模型**: 利用残差连接，解决深度网络的梯度消失问题，提高识别准确率
2. **批量归一化**: 加速模型收敛并提高稳定性
3. **Adam优化器**: 自适应学习率，提高训练效率
4. **数据增强**: 通过图像处理提高模型对各种手写风格的适应性

## 注意事项

- 图像应该尽量包含清晰的单个数字
- 程序会自动处理黑底白字或白底黑字的图像
- 首次运行时会下载MNIST数据集并进行训练，这可能需要一些时间
- 训练后的模型将保存为`digit_model.pth`，后续运行会直接加载该模型
- 如果识别结果不准确，可以尝试使用`prepare_image.py`处理图像
- GPU加速: 如果您的计算机有CUDA兼容的GPU，程序会自动利用GPU加速训练和识别过程
